{% assign image_path = include.path | default: include.src %}
{% assign alt = include.alt | default: "Image" %}
{% assign sizes = include.sizes | default: "(max-width: 800px) 100vw, 800px" %}
{% assign widths = include.widths | default: "320,480,768,1024,1200" | split: "," %}
{% assign lazy = include.lazy | default: "true" %}

<picture class="{{ include.class }}">
  <!-- AVIF Format -->
  <source
    type="image/avif"
    srcset="
      {% for width in widths %}
        {{ image_path | split: '.' | first }}-{{ width }}.avif {{ width }}w{% unless forloop.last %},{% endunless %}
      {% endfor %}
    "
    sizes="{{ sizes }}">
    
  <!-- WebP Format -->
  <source
    type="image/webp"
    srcset="
      {% for width in widths %}
        {{ image_path | split: '.' | first }}-{{ width }}.webp {{ width }}w{% unless forloop.last %},{% endunless %}
      {% endfor %}
    "
    sizes="{{ sizes }}">
    
  <!-- Original Format (Fallback) -->
  <img
    src="{{ image_path | split: '.' | first }}-320.jpg"
    srcset="
      {% for width in widths %}
        {{ image_path | split: '.' | first }}-{{ width }}.jpg {{ width }}w{% unless forloop.last %},{% endunless %}
      {% endfor %}
    "
    alt="{{ alt }}"
    {% if lazy == "true" %}loading="lazy" decoding="async"{% endif %}
    {% if include.width %}width="{{ include.width }}"{% endif %}
    {% if include.height %}height="{{ include.height }}"{% endif %}
    class="{{ include.img_class }}">
</picture> 
